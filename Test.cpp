#include "doctest.h"
#include "mat.hpp"
using namespace ariel;

#include <string>
#include <algorithm>
using namespace std;

/**
 * Returns the input string without the whitespace characters: space, newline and tab.
 * Requires std=c++2a.
 */
string nospaces(string input) {
	std::erase(input, ' ');
	std::erase(input, '\t');
	std::erase(input, '\n');
	std::erase(input, '\r');
	return input;
}


TEST_CASE("Good input") {
	CHECK_NOTHROW(mat(13, 29, 'c', 'h'));
	CHECK_NOTHROW(mat(1, 1, '+', '#'));
	CHECK_NOTHROW(mat(5, 3, '$', '%'));
	CHECK_NOTHROW(mat(75, 133, '^', '*'));
	CHECK_NOTHROW(mat(55, 33, '!', '('));
}

TEST_CASE("Bad input") {
	CHECK_THROWS(mat(10, 5, '$', '%')); // even
    CHECK_THROWS(mat(-1, 5, '$', '%')); // negative
	CHECK_THROWS(mat(2, 4, '$', '%')); // even
	CHECK_THROWS(mat(2, 5, '$', '%'));
	CHECK_THROWS(mat(0, 5, 'd', '%')); // null
	CHECK_THROWS(mat(1, 5, '$', '\0'));
}

TEST_CASE("Actual Big Outputs") {
	CHECK(nospaces(mat(13, 29, 'c', 'h')) == nospaces("ccccccccccccc\n"
														"chhhhhhhhhhhc\n"
														"chccccccccchc\n"
														"chchhhhhhhchc\n"
														"chchccccchchc\n"
														"chchchhhchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchchchchc\n"
														"chchchhhchchc\n"
														"chchccccchchc\n"
														"chchhhhhhhchc\n"
														"chccccccccchc\n"
														"chhhhhhhhhhhc\n"
														"ccccccccccccc"));
	CHECK(nospaces(mat(75, 75, '^', '*')) == nospaces("^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n"
														"^*************************************************************************^\n"
														"^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^\n"
														"^*^*********************************************************************^*^\n"
														"^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^\n"
														"^*^*^*****************************************************************^*^*^\n"
														"^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^\n"
														"^*^*^*^*************************************************************^*^*^*^\n"
														"^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^\n"
														"^*^*^*^*^*********************************************************^*^*^*^*^\n"
														"^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^\n"
														"^*^*^*^*^*^*****************************************************^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*************************************************^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*********************************************^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*****************************************^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*************************************^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*********************************^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*****************************^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*************************^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*********************^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*****************^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*************^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*********^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*****^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^^^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^^^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*****^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*********^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*************^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^*****************^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^*********************^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^*************************^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^*****************************^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^*********************************^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^*************************************^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^*****************************************^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^*********************************************^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^*************************************************^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^*^\n"
														"^*^*^*^*^*^*****************************************************^*^*^*^*^*^\n"
														"^*^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^*^\n"
														"^*^*^*^*^*********************************************************^*^*^*^*^\n"
														"^*^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^*^\n"
														"^*^*^*^*************************************************************^*^*^*^\n"
														"^*^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^*^\n"
														"^*^*^*****************************************************************^*^*^\n"
														"^*^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^*^\n"
														"^*^*********************************************************************^*^\n"
														"^*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*^\n"
														"^*************************************************************************^\n"
														"^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"));
	CHECK(nospaces(mat(55, 33, '!', '(')) == nospaces("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n"
														"!(((((((((((((((((((((((((((((((((((((((((((((((((((((!\n"
														"!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!\n"
														"!(!(((((((((((((((((((((((((((((((((((((((((((((((((!(!\n"
														"!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!\n"
														"!(!(!(((((((((((((((((((((((((((((((((((((((((((((!(!(!\n"
														"!(!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!(!\n"
														"!(!(!(!(((((((((((((((((((((((((((((((((((((((((!(!(!(!\n"
														"!(!(!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!(!(!\n"
														"!(!(!(!(!(((((((((((((((((((((((((((((((((((((!(!(!(!(!\n"
														"!(!(!(!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!(!(!(!\n"
														"!(!(!(!(!(!(((((((((((((((((((((((((((((((((!(!(!(!(!(!\n"
														"!(!(!(!(!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!(!(!(!(!\n"
														"!(!(!(!(!(!(!(((((((((((((((((((((((((((((!(!(!(!(!(!(!\n"
														"!(!(!(!(!(!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!(!(!(!(!(!\n"
														"!(!(!(!(!(!(!(!(((((((((((((((((((((((((!(!(!(!(!(!(!(!\n"
														"!(!(!(!(!(!(!(!(!!!!!!!!!!!!!!!!!!!!!!!(!(!(!(!(!(!(!(!\n"
														"!(!(!(!(!(!(!(!(((((((((((((((((((((((((!(!(!(!(!(!(!(!\n"
														"!(!(!(!(!(!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!(!(!(!(!(!\n"
														"!(!(!(!(!(!(!(((((((((((((((((((((((((((((!(!(!(!(!(!(!\n"
														"!(!(!(!(!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!(!(!(!(!\n"
														"!(!(!(!(!(!(((((((((((((((((((((((((((((((((!(!(!(!(!(!\n"
														"!(!(!(!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!(!(!(!\n"
														"!(!(!(!(!(((((((((((((((((((((((((((((((((((((!(!(!(!(!\n"
														"!(!(!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!(!(!\n"
														"!(!(!(!(((((((((((((((((((((((((((((((((((((((((!(!(!(!\n"
														"!(!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!(!\n"
														"!(!(!(((((((((((((((((((((((((((((((((((((((((((((!(!(!\n"
														"!(!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!(!\n"
														"!(!(((((((((((((((((((((((((((((((((((((((((((((((((!(!\n"
														"!(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!(!\n"
														"!(((((((((((((((((((((((((((((((((((((((((((((((((((((!\n"
														"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"));
}

TEST_CASE("Actual Small Outputs") {
	CHECK(nospaces(mat(1, 1, '+', '#')) == nospaces("+"));
	CHECK(nospaces(mat(5, 3, '$', '%')) == nospaces("$$$$$\n"
													"$%%%$\n"
													"$$$$$"));
	CHECK(nospaces(mat(7, 3, '!', '@')) == nospaces("!!!!!!!\n"
													"!@@@@@!\n"
													"!!!!!!!"));
	CHECK(nospaces(mat(1, 7, '#', '_')) == nospaces("#\n"
													"#\n"
													"#\n"
													"#\n"
													"#\n"
													"#\n"
													"#"));
	CHECK(nospaces(mat(7, 1, '#', '_')) == nospaces("#######"));
	CHECK(nospaces(mat(9, 3, '#', '_')) == nospaces("#########\n"
													"#_______#\n"
													"#########"));
	CHECK(nospaces(mat(15, 5, '+', '-')) == nospaces("+++++++++++++++\n"
													"+-------------+\n"
													"+-+++++++++++-+\n"
													"+-------------+\n"
													"+++++++++++++++"));										
}